<div [ngClass]="{'section': !isSubsection, 'subsection' : isSubsection }">
  <div style="display: flex; align-items: center">
    <h1 class="section-list-title">{{section.section_name}}</h1>
    <app-confirmation-modal *ngIf="isOwner()" (delete)="this.delete()"></app-confirmation-modal>
    <app-edit-section-modal *ngIf="isOwner()" [section]="this.section"
                            (sectionEdit)="this.updateSection($event)"></app-edit-section-modal>
  </div>
  <p class="section-description">{{section.description}}</p>

  <div style="overflow: hidden">
    <div>
      <h1 class="attachment-list-title">Attachments <span style="font-size: small">(max.&nbsp;500&nbsp;MB)</span></h1>
      <div style="width: 90%; float: left">
        <mat-list class="attachment">
          <mat-list-item *ngFor="let attachment of this.attachments" class="attachment-content">
            <div class="attachment-name">
              {{attachment.content}}
            </div>
            <div *ngIf="attachment.isLoading" class="action-buttons">
              <mat-progress-spinner [mode]="'determinate'" [value]="attachment.percentLoaded" diameter="25"></mat-progress-spinner>
            </div>
            <div *ngIf="!attachment.isLoading" class="action-buttons">
              <div *ngIf="isOwner()">
                <button mat-icon-button (click)="deleteAttachment(attachment)">
                  <mat-icon>delete</mat-icon>
                </button>
              </div>
              <div *ngIf="isViewable(attachment)">
                <button mat-icon-button (click)="viewAttachment(attachment)">
                  <mat-icon>panorama</mat-icon>
                </button>
              </div>
              <div>
                <button *ngIf="!attachment.isDownloading" mat-icon-button (click)="getAttachment(attachment)">
                  <mat-icon>arrow_downward</mat-icon>
                </button>
              </div>
              <mat-progress-spinner *ngIf="attachment.isDownloading" [mode]="'determinate'" [value]="attachment.percentDownloaded" diameter="35"></mat-progress-spinner>
            </div>
          </mat-list-item>
          <mat-list-item *ngIf="this.attachments.length===0">
            <div class="attachment-name">
              <span style="color: grey">No attachments here.</span>
            </div>
          </mat-list-item>
        </mat-list>
      </div>

        <input class="file-input" type="file" (change)="onFileSelected($event)" #avatarUpload>
      <div style="width: 10%; float: right; text-align: center; vertical-align: middle; height: 100%" *ngIf="isOwner()">
        <button style="width: 100%" mat-icon-button class="attachment-add" (click)="avatarUpload.click()">
          <mat-icon>add</mat-icon>
        </button>
      </div>
    </div>

    <div>
      <div style="width: 90%; float: left">
        <h1 class="attachment-list-title">{{this.isOwner() ? 'Participants\' attachments' : 'Your attachments'}} <span style="font-size: small">(max.&nbsp;500&nbsp;MB)</span></h1>

        <mat-list class="attachment">
          <mat-list-item *ngFor="let attachment of this.userAttachments" class="attachment-content">
            <div class="attachment-name">
              {{attachment.content}}
              <span *ngIf="isOwner()"> --- {{attachment.user.username}}</span>
            </div>
            <div *ngIf="attachment.isLoading" class="action-buttons">
              <mat-progress-spinner [mode]="'determinate'" [value]="attachment.percentLoaded" diameter="25"></mat-progress-spinner>
            </div>
            <div *ngIf="!attachment.isLoading" class="action-buttons">
              <div *ngIf="isOwner() || isOwnerOfAttachment(attachment)">
                <button mat-icon-button (click)="deleteAttachment(attachment)">
                  <mat-icon>delete</mat-icon>
                </button>
              </div>
              <div *ngIf="isViewable(attachment)">
                <button mat-icon-button (click)="viewAttachment(attachment)">
                  <mat-icon>panorama</mat-icon>
                </button>
              </div>
              <div>
                <button *ngIf="!attachment.isDownloading" mat-icon-button (click)="getAttachment(attachment)">
                  <mat-icon>arrow_downward</mat-icon>
                </button>
              </div>
              <mat-progress-spinner *ngIf="attachment.isDownloading" [mode]="'determinate'" [value]="attachment.percentDownloaded" diameter="35"></mat-progress-spinner>
            </div>
          </mat-list-item>
          <mat-list-item *ngIf="this.userAttachments.length===0">
            <div class="attachment-name">
              <span style="color: grey">No attachments here.</span>
            </div>
          </mat-list-item>
        </mat-list>
      </div>

      <div style="width: 10%; float: right; text-align: center; vertical-align: middle; height: 100%"
           *ngIf="!isOwner()">
        <input class="file-input" type="file" (change)="onFileSelected($event)" #avatarUpload>
        <button style="width: 100%" mat-icon-button class="attachment-add" (click)="avatarUpload.click()">
          <mat-icon>add</mat-icon>
        </button>
      </div>
    </div>
  </div>

  <app-subsection-list *ngIf="this.section.parentSection == null" [section]="this.section" [course]="this.course"
                       [sections]="this.subsections" [isSecondaryTeacher]="isSecondaryTeacher"></app-subsection-list>
</div>
